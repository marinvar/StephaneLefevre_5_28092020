(()=>{"use strict";function e(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(a,o){var i=t.apply(n,r);function c(t){e(i,a,o,c,u,"next",t)}function u(t){e(i,a,o,c,u,"throw",t)}c(void 0)}))}}function n(){return r.apply(this,arguments)}function r(){return(r=t(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fetch("http://localhost:3000/api/teddies");case 3:return t=e.sent,e.abrupt("return",t.json());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(e){return o.apply(this,arguments)}function o(){return(o=t(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="http://localhost:3000/api/teddies/"+t,e.next=3,fetch(n);case 3:return r=e.sent,e.abrupt("return",r.json());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){i(o,r,a,c,u,"next",e)}function u(e){i(o,r,a,c,u,"throw",e)}c(void 0)}))}}function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=[],l=[],f=function e(t,n,r,a,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.name=n,this.colors=r,this.price=a,this.imageUrl=o,this.description=i},m=function(){var e=localStorage.getItem("teddiesCart");null!==localStorage.getItem("teddiesCart")&&(l=JSON.parse(e))},p=function(e){return(parseFloat(e)/100).toFixed(2)+"€"},h=function(e){document.getElementById("teddyCard").setAttribute("id",e.id),document.getElementById("cardTitle").textContent=e.name,document.getElementById("cardPrice").textContent=p(e.price),document.getElementById("cardImg").setAttribute("src",e.imageUrl),document.getElementById("cardCaption").textContent=e.description;var t,n=document.getElementById("teddyColors"),r=u(e.colors);try{for(r.s();!(t=r.n()).done;){var a=t.value,o=document.createElement("option");o.text=a,n.add(o)}}catch(e){r.e(e)}finally{r.f()}},v=function(e){document.getElementById("addToCart").addEventListener("click",(function(){!function(e){var t,n,r=s.findIndex((function(t,n){if(t.id===e)return!0}));r>=0&&s[r],console.log(teddy),m(),l.push(e),t=JSON.stringify(l),localStorage.setItem("teddiesCart",t),(n=document.createElement("div")).classList.add("alert","alert-success","alert-dismissible","fade","show","basket-msg"),n.setAttribute("role","alert"),n.innerHTML='<strong>Well done !</strong> Votre nouvel ami a été ajouté à votre panier...<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',document.getElementsByTagName("body")[0].appendChild(n)}(e)}))},g=function(){var e=c(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a(t);case 3:n=e.sent,r=new f(n._id,n.name,n.colors,n.price,n.imageUrl,n.description),h(r),v(r.id),document.getElementById("backToProducts").setAttribute("href","index.html?productId="+r.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error while looking at Teddy details: ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),y=function(e){var t=document.createElement("article");t.setAttribute("id",e.id),t.classList.add("card","col-6","col-md-4","m-3");var n=document.createElement("figure");n.classList.add("card-body","figure");var r=document.createElement("h4");r.classList.add("card-title"),r.textContent=e.name;var a=document.createElement("h5");a.textContent=p(e.price);var o=document.createElement("img");o.classList.add("card-img-top","figure-img","img-fluid"),o.setAttribute("src",e.imageUrl),o.setAttribute("alt","Un ours en peluche fait main");var i=document.createElement("figcaption");return i.classList.add("card-text","figure-caption"),i.textContent=e.description,n.appendChild(o),n.appendChild(r),n.appendChild(a),n.appendChild(i),t.appendChild(n),function(e){e.addEventListener("click",(function(e){e.stopPropagation(),location.href="productDetails.html?productId="+e.target.id}))}(t),t},b=function(){var e=window.location.search,t=new URLSearchParams(e);return[t.get("productId"),t]},w=function(){if(s.length>0){var e,t=document.getElementById("articles"),n=u(s);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=y(r);t.appendChild(a)}}catch(e){n.e(e)}finally{n.f()}o=b()[0],b()[1].delete("productId"),null!==o&&(window.history.replaceState(null,null,window.location.pathname),function(e){location.hash="#"+e}(o))}else articles.innerHTML="<p>Aucun article dans cette catégorie en ce moment... Veuillez réessayer plus tard !</p>";var o},E=function(){var e=c(regeneratorRuntime.mark((function e(){var t,r,a,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n();case 3:t=e.sent,r=u(t);try{for(r.s();!(a=r.n()).done;)o=a.value,i=new f(o._id,o.name,o.colors,o.price,o.imageUrl,o.description),s.push(i)}catch(e){r.e(e)}finally{r.f()}w(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error during products retrieval or product cards creation",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();!function(){var e=document.getElementsByTagName("body")[0].classList;if(e.contains("homepage"))E();else if(e.contains("product-details-page")){var t=b()[0];g(t)}else e.contains("basket-page")&&function(){m();var e,t=u(l);try{var n=function(){var t=e.value,n=s.findIndex((function(e,n){if(e.id===t)return!0}));if(n>=0){var r=s[n],a=document.createElement("article");a.classList.add("d-flex");var o=document.createElement("h3");o.textContent=r.name;var i=document.createElement("h3");i.textContent=p(r.price),a.appendChild(o),a.appendChild(i),document.getElementById("articles-in-basket").appendChild(a)}};for(t.s();!(e=t.n()).done;)n()}catch(e){t.e(e)}finally{t.f()}}()}()})();